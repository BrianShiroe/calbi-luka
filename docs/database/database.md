# Database Schema Documentation

This document outlines the structure and purpose of the database schema used for managing user authentication, camera surveillance, recordings, alerts, and system settings.

## Tables

### 1. `user`
Stores user information for authentication and role-based access control.

```sql
CREATE TABLE user (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT UNIQUE NOT NULL,
    password TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    role TEXT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```
- `id`: Unique identifier for the user.
- `username`: Unique username for login.
- `password`: Hashed password for authentication.
- `email`: Unique email address.
- `role`: User role (e.g., admin, viewer, operator).
- `created_at`: Timestamp of user creation.

### 2. `access_log`
Logs user actions within the system.

```sql
CREATE TABLE access_log (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    action TEXT,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE
);
```
- `id`: Unique identifier for the log entry.
- `user_id`: References the user who performed the action.
- `action`: Description of the action taken.
- `timestamp`: When the action occurred.

### 3. `settings`
Stores configuration settings for the system.

```sql
CREATE TABLE settings (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    detection_mode INTEGER,
    show_bounding_box INTEGER,
    performance_metrics_toggle INTEGER,
    confidence_level FLOAT,
    max_frame_rate INTEGER,
    update_metric_interval INTEGER,
    metric_font_size INTEGER,
    target_objects TEXT
);
```
- `detection_mode`: Toggle object detection on/off.
- `show_bounding_box`: Display bounding boxes.
- `performance_metrics_toggle`: Enable/disable performance monitoring.
- `confidence_level`: Detection confidence threshold.
- `max_frame_rate`: Maximum allowed frame rate.
- `update_metric_interval`: Interval for updating metrics.
- `metric_font_size`: Font size for displaying metrics.
- `target_objects`: List of objects to detect.

### 4. `camera`
Stores information about registered cameras.

```sql
CREATE TABLE camera (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT,
    ip_address TEXT,
    location TEXT,
    status TEXT,
    installed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```
- `id`: Unique camera identifier.
- `title`: Camera name/title.
- `ip_address`: IP address of the camera.
- `location`: Physical location of the camera.
- `status`: Current operational status.
- `installed_at`: Installation timestamp.

### 5. `recording`
Manages recorded video files.

```sql
CREATE TABLE recording (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    camera_id INTEGER NOT NULL,
    file_path TEXT,
    recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    duration INTEGER,
    FOREIGN KEY (camera_id) REFERENCES camera(id) ON DELETE CASCADE
);
```
- `id`: Unique recording identifier.
- `camera_id`: References the recording camera.
- `file_path`: Storage location of the recording.
- `recorded_at`: Timestamp when recording was made.
- `duration`: Length of recording in seconds.

### 6. `report`
Stores reports related to camera activity.

```sql
CREATE TABLE report (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    camera_id INTEGER NOT NULL,
    report_level TEXT,
    description TEXT,
    FOREIGN KEY (camera_id) REFERENCES camera(id) ON DELETE CASCADE
);
```
- `id`: Unique report identifier.
- `camera_id`: References the camera the report is about.
- `report_level`: Severity or type of report (e.g., warning, error, info).
- `description`: Details of the report.

### 7. `alert`
Handles alerts generated by detection events.

```sql
CREATE TABLE alert (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    camera_id INTEGER NOT NULL,
    camera_title TEXT,
    event_type TEXT,
    alert_level TEXT,
    location TEXT,
    detected_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    resolved INTEGER CHECK(resolved IN (0, 1)) DEFAULT 0,
    FOREIGN KEY (camera_id) REFERENCES camera(id) ON DELETE CASCADE
);
```
- `id`: Unique alert identifier.
- `camera_id`: References the camera that triggered the alert.
- `camera_title`: Camera name/title.
- `event_type`: Type of detected event.
- `alert_level`: Severity of the alert (e.g., critical, warning, info).
- `location`: Location of the detected event.
- `detected_at`: Timestamp when the event was detected.
- `resolved`: Status (0 = unresolved, 1 = resolved).

## Summary
This schema is designed for a video surveillance system, supporting user authentication, camera management, recording storage, alert monitoring, and system configurations. The relationships between tables ensure data consistency and allow efficient tracking of system activity.